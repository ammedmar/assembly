% !TeX root = ../assembly.tex

\subsection{Conventions}

We write $(\Ch, \ot, \Z)$ for the symmetric monoidal category of chain complexes of free $\Z$-modules, i.e. modules admitting a basis, $\sym_2$ for the group with only one non-identity element $T$, and $X$ for an unspecified simplicial complex.
In this work, the vertices of a simplicial complex are equipped with a partial order compatibly restricting to a total order on each simplex.
We denote the usual integral chains of $X$ by $\chains(X)$.

\subsection{Presheaves}\label{ss:presheaves}

Regard $X$ as a poset category with a morphism $x \to y$ whenever $x$ is a subsimplex of $y$.
The category of \textit{presheaves on} $X$ is the category of functors $\Fun(X^\op, \Ch)$.
Given a presheaf $\cN$ on $X$, we will denote the chain complex it associates to a simplex $x$ by $\cN_x$ and the linear map associated to a morphism $x \to y$ by $\cN_{x \to y}$.
We remark that this category is enriched over $\Ch$.
These presheaves were termed ``local systems'' in \cite{ranicki1990assembly} where $X$ was allowed to be a semi-simplicial set.
We do not use this terminology since the associated topological sheaf --which we describe next-- does not need to be locally constant.

\subsection{Remark on topological sheaves}\label{ss:topological sheaf}

The set of simplices of $X$ can be endowed with a topology making presheaves as defined above into topological sheaves.
Explicitly, this topology on the set of simplices of $X$ is generated by subsets $\bar y = \set{x \in X : x \to y}$.
Notice that, as a poset, $X$ and the category of open sets of this topology are isomorphic.
Therefore, so are their categories of presheaves.
It can be verified that these topological presheaves are indeed topological sheaves.

\subsection{Symmetric coalgebras}

Let $W$ be the minimal free resolution of $\Z$ by free $\Z[\sym_2]$-modules:
\[
\Z[\sym_2]\set{e_0} \xla{1-T} \Z[\sym_2]\set{e_1} \xla{1+T} \Z[\sym_2]\set{e_2} \xla{1-T} \dotsb.
\]
The symbol $e_i$ simply denotes a preferred basis element.
The data of a \textit{symmetric coalgebra} is an augmented chain complex $\varepsilon \colon C \to \Z$ and an $\sym_2$-equivariant chain map
\[
\triangle \colon W \ot C \to C \ot C,
\]
where the action of $\sym_2$ in the target is given by transposition, and on the domain is concentrated in $W$.
We will write $\triangle_i$ for $\triangle(e_i \ot -)$ and demand the triple $(C, \triangle_0, \varepsilon)$ to be a coalgebra, i.e., a comonoid in $\Ch$.
Notice that
\[
\bd(\triangle_i) = \big( 1+(-1)^i T \big) \triangle_{i-1}
\]
with the convention $\triangle_{-1} = 0$.

\subsection{Remark on higher categories}\label{ss:higher categories}

An $\omega$-category, also known as a strict infinity category, is the limiting concept obtained from the recursive definition of an $n$-category as a category enriched in $(n-1)$-categories.
Building on ideas from \cite{brown1981cubes, kapranov1991polycategory, steiner2004omega}, in \cite{medina2020globular} a functor from a full subcategory of symmetric coalgebras to $\omega$-categories was constructed and shown to be an equivalence onto a full subcategory recently characterized intrinsically in \cite{ozornova2022steiner}.
Applying this functor to the coalgebra \cref{ss:cup-i} defined by Steenrod on $\chains(\simplex^n)$ recovers Street's $n^\th$ oriental $\cO_n$, the free $\omega$-category generated by the standard $n^\th$ simplex \cite{street1987orientals}.
These are used to define the category generated by a simplicial set $\cO(X) = \colim_{\simplex^n \downarrow X} \cO_n$ and the nerve of an $\omega$-category $\rN(\cC)_n = \omega \Cat(\cO_n, \cC)$.

\subsection{Diagonal, augmentation and join}

The \textit{Alexander--Whitney coproduct}
\[
\copr_0 \colon \chains(X) \to \chains(X) \ot \chains(X)
\]
is defined on a basis element $[v_0, \dots, v_n]$ by
\begin{equation*}\label{e:alexander-whitney coalgebra}
	\copr_0 \big( [v_0, \dots, v_n] \big) =
	\sum_{k=0}^n \ [v_0, \dots, v_k] \ot [v_k, \dots, v_n].
\end{equation*}
We mention that the triple $(\chains(X), \copr_0, \aug)$ where $\aug \colon \chains(X) \to \Z$ is the usual \textit{augmentation map} is a coalgebra.

The \textit{join product}
\[
\ast \colon \chains(X) \ot \chains(X) \to \chains(X)
\]
is the natural degree~$1$ linear map defined on a basis element
\[
[v_0, \dots, v_p] \ot [v_{p+1}, \dots, v_q]
\]
to be $0$ if $\set{v_\ell : \ell = 0, \dots, q}$ is not the set of vertices of a $q$-simplex in $X$, otherwise
\[
\ast \big(\left[v_0, \dots, v_p \right] \ot \left[v_{p+1}, \dots, v_q\right]\big) =
(-1)^{p} \sign(\pi) \left[v_{\pi(0)}, \dots, v_{\pi(q)}\right]
\]
where $\pi$ is the permutation that orders the vertices.

\subsection{Steenrod construction}\label{ss:cup-i}

We will now describe Steenrod's construction of cup-$i$ coproducts \cite[p.293]{steenrod1947products} which makes $\chains(X)$ into a symmetric coalgebra.
Let
\[
\copr \colon W \ot \chains(X) \to \chains(X) \ot \chains(X)
\]
be the $\sym_2$-equivariant chain map determined by the linear maps $\copr_i = \copr(e_i \ot -)$ defined recursively for $i > 1$ by
\begin{equation}\label{e:cup-i coproducts}
	\copr_i =
	(\ast \ot \id) \circ (\id \ot T\!\copr_{i-1}) \circ \copr_0.
\end{equation}
We referred to these as \textit{cup-$i$ coproducts}.
The triple $(\chains(X), \copr, \aug)$ forms a symmetric coalgebra which we refer to as the \textit{Steenrod cup-$i$ coalgebra} of $X$.

Alternative descriptions of cup-$i$ coproducts, all shown to be equivalent to Steenrod's original via an axiomatic characterization \cite{medina2022axiomatic}, can be found in \cite{real1996computability, gonzalez-diaz1999steenrod, mcclure2003multivariable, medina2023fast_sq}.

\subsection{Special cases}\label{ss:special_cases}

We will use the following special values of the Steenrod cup-$i$ coalgebra.
The specific signs determined by \eqref{e:cup-i coproducts} play no role in our arguments, so we write $\pm$ for either $+$ or $-$.
For a basis element $x$ of $\chains(X)_n$ and $i > n$ we have:
\begin{align}
	&\copr_i(x) = 0, \\
	&\copr_n(x) = \pm \, x \ot x, \\
	&\copr_{n-1}(x) =
	\sum_{u \text{ even}} \pm \, x \ot \face_u(x) \ +
	\sum_{u \text{ odd}} \pm \face_u(x) \ot x.
\end{align}
where, as usual, $\face_u [v_0,\dots,v_n] = [v_0,\dots,\widehat{v}_u,\dots,v_n]$.

\subsection{Remark on Steenrod squares}\label{ss:steenrod squares}

We mention that Steenrod's introduction of the cup-$i$ coproducts $\copr_i$ was motivated by the desire to construct finer invariants on the cohomology of spaces with mod 2 coefficients.
These are the celebrated \textit{Steenrod squares}
\[
\Sq^k \colon \rH^\bullet(X; \Ftwo) \to \rH^\bullet(X; \Ftwo)
\]
defined on a class $[\alpha]$ of cohomological degree $n$ by
\[
\Sq^k [\alpha] = \big[ (\alpha \ot \alpha) \copr_{n-k}(-) \big].
\]
They satisfy the following two well known relations.
The \textit{Cartan relation} establishes a connection between Steenrod squares and the cup product, it is given by:
\[
\Sq^k \big( [\alpha] [\beta] \big) =
\sum_{i+j=k} \, \Sq^i\big([\alpha]\big) \Sq^j\big([\beta]\big).
\]
The \textit{Adem relation} controls the iteration of Steenrod operations, and it is given by:
\[
\Sq^i \Sq^j =
\sum_{k=0}^{\lfloor i/2 \rfloor} \binom{j-k-1}{i-2k} \Sq^{i+j-k} \Sq^k.
\]
These relations can be proven using Steenrod cup-$i$ coproducts of \cref{ss:cup-i} directly \cite{medina2020cartan, medina2021adem, medina2023oddcartan}.

We also mention that analogues of the cup-$i$ coproducts modeling Steenrod operations at odd primes were defined in \cite{medina2021may_st} and implemented in \cite{medina2021comch}.

\subsection{Remark on $E_\infty$-structures}

Although we do not use the following fact in this work, we mention that the cup-$i$ coproducts of Steenrod are part of much larger structure derived from the symmetry of the diagonal of spaces.
This fully derived diagonal is known as a $E_\infty$-coalgebra structure on the chains of simplicial sets.
The importance of $E_\infty$-structures is highlighted by a result of Mandell \cite{mandell2006homotopy_type} stating that finite type nilpotent spaces are weakly equivalent if and only if their singular cochains are quasi-isomorphic as $E_\infty$-algebras.
Explicitly, a natural $E_\infty$-coalgebra structure on $\chains(X)$ is given by all maps $\chains(X) \to \chains(X)^{\ot r}$ for any $r > 0$ obtained from compositions of the Alexander--Whitney coproduct and the join product.
The underlying model for the $E_\infty$-operad use in this statement is presented in \cite{medina2020prop1, medina2021prop2}.
We mention that this $E_\infty$-coalgebra structure on simplicial chains generalizes the $E_\infty$-coalgebras of McClure--Smith \cite{mcclure2003multivariable} and Berger--Fresse \cite{berger2004combinatorial}.
For a discussion using cubes or multisimplices in place of simplices please consult \cite{medina2022cube_einfty, medina2022multisimplicial}.

\subsection{Comodules}

A \textit{comodule} over a symmetric coalgebra $(C, \triangle, \aug)$ is a chain complex $N$ together with a chain map
\[
\downtriangle \colon W \ot N \to N \ot C
\]
restricting to a comodule over the coalgebra $(C, \triangle_0, \aug)$.
More explicitly, we demand $(N, \downtriangle_{\!0} \defeq \downtriangle(e_0 \ot -))$ to be a comodule over $(C, \triangle_0, \aug)$.

We will denote by $\coMod_C^{\sym_2}$ the category of such comodules with strict morphisms, i.e. linear maps $f \colon N \to N'$ making the following diagram
\[
\begin{tikzcd}
	W \ot N \arrow[d, "\triangledown"] \arrow[r, "\id\, \ot f"] &
	W \ot N' \arrow[d, "\triangledown'"] & \\
	N \ot C \arrow[r, "f \ot\, \id"] &
	N' \ot C
\end{tikzcd}
\]
commute.
We remark that this category is enriched in $\Ch$.

\subsection{Closure cosheaf}

For any simplex $x$ in $X$ denote by $\bar x$ the subcomplex of $X$ containing the subsimplices of $x$.
The \textit{closure cosheaf} is the (covariant) functor from the poset category of $X$ to $\Ch$ defined on objects by $x \mapsto \chains(\bar x)$ and on morphisms by canonical inclusions $\chains_{x \to y} \colon \chains(\bar x) \to \chains(\bar y)$.

For any simplex $y$ in $X$ and subsimplex $x$, we will find it convenient to identify the basis element $x$ in $\chains(\bar y)$ with the unique morphism $(x \to y)$.
In particular, we have $\chains_{y \to z} (x \to y) = (x \to z)$.

\subsection{Assembly}\label{ss:assembly}

The \textit{assembly functor}
\[
\assembly \colon \Fun(X^\op, \Ch) \to \Ch
\]
is given by tensoring over $X$ with the closure cosheaf.
Explicitly, let $\cN$ be a sheaf on $X$, then
\[
\assembly \cN = \bigoplus_{x \in X} \chains(\bar x) \ot \cN_x \ / \sim
\]
where for simplices $x \to y \to z$ and $c \in \cN_z$ we have
\[
(x \to z) \ot c \ \sim \, (x \to y) \ot \cN_{y \to z}(c)
\]
and for a morphism $F \colon \cN \to \cN'$ of presheaves on $X$ we have
\[
\assembly F[(x \to y) \ot c] = [(x \to y) \ot F_y(c)].
\]
We remark that this is a functor of categories enriched in $\Ch$.

If $X$ is simply-connected, this definition agrees with the one given by Ranicki--Weiss in \cite[Definition 1.4]{ranicki1990assembly}.
We will use the definition above for $X$ not necessarily simply-connected, remarking that it can be applied to the the universal cover of $X$ to recover the definition given by Ranicki and Weiss.

We mention that the assembly of the sheaf $\underline \Z$ with constant value $\Z$ and only identity maps satisfies
\[
\assembly \underline{\Z} \cong \chains(X).
\]

\subsection{Lift to comodules}

We will describe a factorization of the assembly functor
\[
\assembly \colon \Fun(X^\op, \Ch) \to \coMod^{\sym_2}_{\chains(X)} \to \Ch
\]
where the second arrow is the forgetful functor.

Let $\cN$ be a presheaf on $X$ and let
\[
\nabla \colon W \ot \assembly \cN \to \chains(X) \ot \assembly \cN
\]
be the chain map defined by the linear maps
\[
\nabla_i \defeq \nabla(e_i \ot -)
\quad \text{ and } \quad
\nabla_i^T \defeq \nabla(Te_i \ot -)
\]
which on a pair of simplices $x \to y$ and an element $c \in \cN_y$ are given by
\[
\nabla_i \big( [(x \to y) \ot c] \big) =
\sum_{\lambda \in \Lambda} \alpha_\lambda \, x_\lambda^{(1)} \ot [(x_\lambda^{(2)} \to y) \ot c]
\]
and
\[
\nabla_i^T \big( [(x \to y) \ot c] \big) =
\sum_{\lambda \in \Lambda} \alpha^T_\lambda \, x_\lambda^{(2)} \ot [(x_\lambda^{(1)} \to y) \ot c],
\]
where
\[
\copr_i(x) = \sum_{\lambda \in \Lambda} \alpha_\lambda \, x_\lambda^{(1)} \ot x_\lambda^{(2)}
\]
and
\[
T \copr_i(x) =
\sum_{\lambda \in \Lambda} \alpha^T_\lambda \, x_\lambda^{(2)} \ot x_\lambda^{(1)}.
\]
The superscript $(1)$ and $(2)$ here are used to suggest positions in a tensor product, as in Sweedler's notation.

\begin{lemma*}
	The map $\nabla$ naturally makes the assembly of a presheaf on $X$ into a comodule over the symmetric coalgebra $\chains(X)$.
\end{lemma*}

\begin{proof}
	The only part of the statement that is not immediate is the claim that $\nabla$ is well defined.
	For $i \in \N$, consider a presheaf $\cN$ on $X$, simplices $x \to y \to z$ and an element $c \in \cN_z$, then
	\begin{align*}
		\nabla_i [(x \to z) \ot c] &=
		\sum \alpha_\lambda \, x^{(1)}_\lambda \ot {[(x^{(2)}_\lambda \to z) \ot c]} \\ &=
		\sum \alpha_\lambda \, x^{(1)}_\lambda \ot [(x^{(2)}_\lambda \to y) \ot \cN_{y \to z}(c)] \\ &=
		\nabla_i [(x \to y) \ot \cN_{y \to z}(c)].
	\end{align*}
	A similar argument applies to $\nabla^T_i$ and completes the proof.
\end{proof}

A similar construction was presented by Ranicki--Weiss in \cite[Proposition~5.3]{ranicki1990assembly}.
In the simply-connected case, $\nabla_0$ agrees with their coaction of the Alexander--Whitney coalgebra of $X$ on $\assembly \cN$.