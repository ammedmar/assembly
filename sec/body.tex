% !TeX root = ../assembly.tex

\subsection{Conventions}

We write $(\Ch, \ot, \Z)$ for the symmetric monoidal category of chain complexes of free $\Z$-modules, $\Sym_2$ for the group with only one non-identity element $T$, and $X$ for an unspecified simplicial complex.
In this work, the vertices of a simplicial complex are equipped with a partial order compatibly restricting to a total order on each simplex.
We denote the usual integral chains of $X$ by $\chains(X)$.

\subsection{Presheaves}\label{ss:presheaves}

Regard $X$ as a poset category with a morphism $x \to y$ whenever $x$ is a subsimplex of $y$.
The category of \textit{presheaves on} $X$ is the category of functors $\Fun(X^\op, \Ch)$.
Given a presheaf $\cN$ on $X$, we will denote the chain complex it associates to a simplex $x$ by $\cN_x$ and the linear map associated to a morphism $x \to y$ by $\cN_{x \to y}$.
We remark that this category is enriched over $\Ch$.
These presheaves were termed ``local systems'' in \cite{ranicki1990assembly} where $X$ was allowed to be a semi-simplicial set.
We do not use this terminology since the associated topological sheaf --which we describe next-- needs not be locally constant.

\subsection{Remark on topological sheaves}\label{ss:topological sheaf}

The set of simplices of $X$ can be endowed with a topology making presheaves as defined above into topological sheaves.
Explicitly, this topology on the set of simplices of $X$ is generated by subsets $\bar y = \set{x \in X \mid x \to y}$.
Notice that as poset categories $X$ and the category of open sets of this topology are isomorphic.
Therefore, so are their categories of chain complex valued presheaves.
It can be verified that these topological presheaves are indeed sheaves.

\subsection{Symmetric coalgebras}

%We now introduce a derived notion of $\Sym_2$-symmetric coalgebra.
%We avoid the term cocommutative since we do not consider higher arity compositions.
Let $W$ be the minimal free resolution of $\Z$ by free $\Z[\Sym_2]$-modules:
\[
\Z[\Sym_2]\set{e_0} \xla{1-T} \Z[\Sym_2]\set{e_1} \xla{1+T} \Z[\Sym_2]\set{e_2} \xla{1-T} \dotsb.
\]
The data of a \textit{symmetric coalgebra} is an augmented chain complex $\varepsilon \colon C \to \Z$ and an $\Sym_2$-equivariant chain map
\[
\triangle \colon W \ot C \to C \ot C,
\]
where the action of $\Sym_2$ in the domain is induced from that in $W$ and in the target is given by transposition.
We will write $\triangle_i$ for $\triangle(e_i \ot -)$, noticing that
\[
\partial(\triangle_i) = \big( 1+(-1)^i T \big) \triangle_{i-1}
\]
with the convention $\triangle_{-1} = 0$, and demand the triple $(C, \triangle_0, \varepsilon)$ to be a coalgebra.
More specifically, a comonoid in $\Ch$.

\subsection{Remark on higher categories}
\label{ss:higher categories}

An $\omega$-category is the limiting concept obtained from the recursive definition of an $n$-category as a category enriched in $(n-1)$-categories.
Building on ideas from \cite{brown1981cubes, kapranov1991polycategory, steiner2004omega}, in \cite{medina2020globular} a functor from a full subcategory of symmetric coalgebras to $\omega$-categories was constructed and shown to be an equivalence onto a full subcategory recently characterized intrinsically in \cite{ozornova2022steiner}.
This functor applied to Steenrod's cup-$i$ coalgebra (\cref{ss:cup-i}) recovers Street's orientals \cite{street1987orientals}.

\subsection{Diagonal, augmentation and join}

The \textit{Alexander--Whitney coproduct}
\[
\copr_0 \colon \chains(X) \to \chains(X) \ot \chains(X)
\]
is defined on a basis element $[v_0, \dots, v_n]$ by
\begin{equation*}\label{e:alexander-whitney coalgebra}
	\copr_0 \big( [v_0, \dots, v_n] \big) =
	\sum_{k=0}^n \ [v_0, \dots, v_k] \ot [v_k, \dots, v_n].
\end{equation*}
We mention that the triple $(\chains(X), \copr_0, \aug)$ where $\aug \colon \chains(X) \to \Z$ is the usual \textit{augmentation map} is a coalgebra.

%\[
%\aug \colon \chains(X) \to \Z
%\]
%is defined $x \in \chains(X)_n$ by
%\begin{equation*}\label{e:augmentation map}
%	\aug(x) =
%	\begin{cases}
%		1 & n = 0, \\
%		0 & n > 0.
%	\end{cases}
%\end{equation*}
%It satisfies
%\begin{gather}
%	\label{e:coassociativity relation}
%	(\copr_0 \ot \, \id) \circ \copr_0 = (\id \ot \copr_0) \circ \copr_0.
%	\label{e:counital relation}
%	(\aug \ot \, \id) \circ \copr_0 = \id = (\id \ot \aug) \circ \copr_0.
%\end{gather}
%making the (normalized) chains $\chains(X)$ of any simplicial set $X$ into a natural coassociative counital coalgebra, referred to as the \textit{Alexander--Whitney coalgebra} of $X$.
%We will use the following recursively defined notation:
%\begin{align*}
%	\copr_0^1 &= \copr_0, \\
%	\copr_0^k &= (\copr_0 \ot \, \id) \circ \copr_0^{k-1},
%\end{align*}
%remarking that
%\[
%(\copr_0 \ot \, \id) \circ \copr_0^k = (\id \ot \copr_0) \circ \copr_0^k.
%\]
%\subsection{Join}
The \textit{join product}
\[
\ast \colon \chains(X) \ot \chains(X) \to \chains(X)
\]
is the natural degree~$1$ linear map defined on a basis element
\[
[v_0, \dots, v_p] \ot [v_{p+1}, \dots, v_q]
\]
to be $0$ if $\set{v_\ell : \ell = 0, \dots, q}$ is not the set of vertices of a simplex in $X$ or if $v_i = v_j$ for some $i \neq j$,
otherwise
\[
\ast \big(\left[v_0, \dots, v_p \right] \ot \left[v_{p+1}, \dots, v_q\right]\big) =
(-1)^{p} \sign(\pi) \left[v_{\pi(0)}, \dots, v_{\pi(q)}\right]
\]
where $\pi$ is the permutation that orders the vertices.
%It is an algebraic version of the usual join of faces in a simplex, please consult \cref{f:join of faces} for an example.

%\begin{figure}
%	\input{aux/join}
%	\caption{Geometric representation of the join product of two basis elements. It depicts the identity $\pr \big( [0] \otimes [1,2] \big) = [0,1,2]$.}
%	\label{f:join of faces}
%\end{figure}

\subsection{Steenrod construction}\label{ss:cup-i}

We will now describe Steenrod's construction of cup-$i$ coproducts \cite[p.293]{steenrod1947products} making $\chains(X)$ into a symmetric coalgebra.
Let
\[
\copr \colon W \ot \chains(X) \to \chains(X) \ot \chains(X)
\]
be the $\Sym_2$-equivariant chain map determined by the linear maps $\copr_i = \copr(e_i \ot -)$, referred to as \textit{cup-$i$ coproducts}, recursively defined for $i > 1$ by
\begin{equation*}\label{e:cup-i coproducts}
	\copr_i =
	(\ast \ot \id) \circ (\id \ot T\copr_{i-1}) \circ \copr_0.
\end{equation*}
The triple $(\chains(X), \copr, \aug)$ forms a symmetric coalgebra which we refer to as the \textit{Steenrod cup-$i$ coalgebra} of $X$.

Alternative descriptions of cup-$i$ coproducts, all shown to be equivalent to Steenrod's original via an axiomatic characterization \cite{medina2022axiomatic}, can be found in \cite{real1996computability, gonzalez-diaz1999steenrod, mcclure2003multivariable, medina2021fast_sq}.
These axiomatized cup-$i$ coproducts seem to be combinatorially fundamental, being constructed from the convex geometry of the standard simplex $\gsimplex^n$ in $\R^n$ given a generic orthonormal basis \cite{medina2022fib_poly}.

\subsection{Special cases}

We will use the following special values of the Steenrod cup-$i$ coalgebra.
For a basis element $x$ of $\chains(X)_n$ and $i > n$ we have:
\begin{align}
	&\copr_i(x) = 0, \\
	&\copr_n(x) = \pm \, x \ot x, \\
	&\copr_{n-1}(x) =
	\sum_{u \text{ even}} \pm \face_u(x) \ot x \ +
	\sum_{u \text{ odd}} \pm \, x \ot \face_u(x),
\end{align}
where $\pm$ stands for an unspecified sign and $\face_u [v_0,\dots,v_n] = [v_0,\dots,\widehat{v}_u,\dots,v_n]$.

\subsection{Remark on Steenrod squares}\label{ss:steenrod squares}

We mention that Steenrod's introduction of the cup-$i$ coproducts $\copr_i$ was motivated by the desire to construct finer invariants on the cohomology of spaces with mod 2 coefficients.
These are the celebrated \textit{Steenrod squares}
\[
Sq^k \colon H^\bullet(X; \Ftwo) \to H^\bullet(X; \Ftwo)
\]
defined on a class $[\alpha]$ of cohomological degree $n$ by
\[
Sq^k [\alpha] = \big[ (\alpha \ot \alpha) \copr_{n-k}(-) \big].
\]

\subsection{Remark on $E_\infty$-structures}

Although we do not use the following fact in this work, we mention that the cup-$i$ coproducts of Steenrod are part of much larger structure derived from the symmetry of the diagonal of spaces; that of an $E_\infty$-coalgebra structure.
Explicitly, this structure is given by all maps $\chains(X) \to \chains(X)^{\ot r}$ for any $r > 0$ obtained from compositions of the Alexander--Whitney coproduct and the join product.
The underlying model for the $E_\infty$-operad use in this statement is presented in \cite{medina2020prop1, medina2021prop2}.
We mention that this $E_\infty$-coalgebra structure on simplicial chains is compatible with the $E_\infty$-coalgebras of McClure--Smith \cite{mcclure2003multivariable} and Berger--Fresse \cite{berger2004combinatorial}.
We also mention that analogues of the cup-$i$ coproducts modeling Steenrod operations at odd primes were defined in \cite{medina2021may_st} and implemented in \cite{medina2021comch}.

\subsection{Comodules}

The data of a \textit{comodule} over a symmetric coalgebra $(C, \triangle, \aug)$ is a chain complex $N$ together with a chain map
\[
\downtriangle \colon W \ot N \to N \ot C.
\]
We will write $\downtriangle_i$ for $\downtriangle(e_i \ot -)$ and $\downtriangle_i^T$ for $\downtriangle(Te_i \ot -)$, and demand that $(N, \downtriangle_{\!0})$ be a comodule over the coalgebra $(C, \triangle_0, \aug)$.

We will denote by $\coMod_C^{\Sym_2}$ the category of such comodules with strict morphisms, i.e. linear maps $f \colon N \to N'$ making the following diagram
\[
\begin{tikzcd}
	W \ot N \arrow[d, "\triangledown"] \arrow[r, "\id\, \ot f"] &
	W \ot N' \arrow[d, "\triangledown'"] & \\
	N \ot C \arrow[r, "f \ot\, \id"] &
	N' \ot C
\end{tikzcd}
\]
commute.
We remark that this category is enriched in $\Ch$.

Although we do not use this fact, we mention that the examples of comodules we will construct make the following diagram commute up to homotopy
\[
\begin{tikzcd}
	W \ot W \ot N \arrow[r, "\id\, \ot \triangledown"] \arrow[d, "\id\, \ot \triangledown"'] &
	W \ot N \ot C \arrow[d, "(\id\, \ot \triangle)(T \ot \id)"] \\
	W \ot N \ot C \arrow[r, "\triangledown \ot\, \id"] &
	N \ot C \ot C.
\end{tikzcd}
\]

\subsection{Closure cosheaf}

For any simplex $x$ in $X$ denote by $\bar x$ the subcomplex of $X$ containing the subsimplices of $x$.
The \textit{closure cosheaf} is the (covariant) functor from the poset category of $X$ to $\Ch$ defined on objects by $x \mapsto \chains(\bar x)$ and on morphisms by canonical inclusions $\chains_{x \to y} \colon \chains(\bar x) \to \chains(\bar y)$.

For any simplex $y$ in $X$ and subsimplex $x$, we will find it convenient to identify the basis element $x$ in $\chains(\bar y)$ with the unique morphism $(x \to y)$.
In particular, we have $\chains_{y \to z} (x \to y) = (x \to z)$.
%, but we continue writing $y$ instead of $(y \to y)$.
%In particular, the canonical inclusion associated to $y \to z$ is given by
%\begin{align*}
%	\chains(\bar y) &\to \chains(\bar z) \\
%	(x \to y) &\mapsto (x \to z).
%\end{align*}

\subsection{Assembly}\label{ss:assembly}

The \textit{assembly functor}
\[
\assembly \colon \Fun(X^\op, \Ch) \to \Ch
\]
is given by tensoring on $X$ with the closure cosheaf.
Explicitly, let $\cN$ be a sheaf on $X$, then
\[
\assembly \cN = \bigoplus_{x \in X} \chains(\bar x) \ot \cN_x \ / \sim
\]
where for simplices $x \to y \to z$ and $c \in \cN[z]$ we have
\[
(x \to z) \ot c \ \sim \, (x \to y) \ot \cN_{y \to z}(c)
\]
and for a morphism $F \colon \cN \to \cN'$ of presheaves on $X$ we have
\[
\assembly F[(x \to y) \ot c] = [(x \to y) \ot F_y(c)].
\]
We remark that this is a functor of categories enriched in $\Ch$.

If $X$ is simply-connected, this definition agrees with the one given by Andrew and M. Weiss in \cite[Definition 1.4]{ranicki1990assembly}.
We will use the definition above for $X$ not necessarily simply-connected spaces, remarking that it can be applied to the the universal cover $\widetilde{X}$ of $X$ to recover their definition.

\subsection{Lift to comodules}

We will describe a factorization of the assembly functor
\[
\assembly \colon \Fun(X^\op, \Ch) \to \coMod^{\Sym_2}_{\chains(X)} \to \Ch
\]
where the second arrow is the obvious forgetful functor.

Let $\cN$ be a presheaf on $X$ and let
\[
\nabla \colon W \ot \assembly \cN \to \chains(X) \ot \assembly \cN
\]
be the chain map defined by the linear maps
\[
\nabla_i \defeq \nabla(e_i \ot -)
\quad \text{ and } \quad
\nabla_i^T \defeq \nabla(Te_i \ot -)
\]
which on a pair of simplices $x \to y$ and an element $c \in \cN_y$ are given by
\[
\nabla_i \big( [(x \to y) \ot c] \big) =
\sum_{\lambda \in \Lambda} {[(x_\lambda^{(1)} \to y) \ot c]} \ot \alpha_\lambda \, x_\lambda^{(2)}
\]
and
\[
\nabla_i^T \big( [(x \to y) \ot c] \big) =
\sum_{\lambda \in \Lambda} {[(x_\lambda^{(2)} \to y) \ot c]} \ot \alpha^T_\lambda \, x_\lambda^{(1)}
\]
where
\[
\copr_i(x) = \sum_{\lambda \in \Lambda} \alpha_\lambda \, x_\lambda^{(1)} \ot x_\lambda^{(2)}
\]
and
\[
T \copr_i(x) =
\sum_{\lambda \in \Lambda} \alpha^T_\lambda \, x_\lambda^{(2)} \ot x_\lambda^{(1)}.
\]

\begin{lemma*}
	The map $\nabla$ naturally makes the assembly of a presheaf on $X$ into a comodule over the symmetric coalgebra $\chains(X)$.
\end{lemma*}

\begin{proof}
	The only part of the statement that is not immediate is that $\nabla$ is well defined.
	For $i \in \N$, consider a presheaf $\cN$ on $X$, simplices $x \to y \to z$ and an element $c \in \cN_z$, then
	\begin{align*}
		\nabla_i [(x \to z) \ot c] &=
		\sum {[(x^{(1)}_\lambda \to z) \ot c]} \ot \alpha_\lambda \, x^{(2)}_\lambda \\ &=
		\sum {[(x^{(1)}_\lambda \to y) \ot \cN_{y \to z}(c)]} \ot \alpha_\lambda \, x^{(2)}_\lambda \\ &=
		\nabla_i [(x \to y) \ot \cN_{y \to z}(c)].
	\end{align*}
	A similar argument applies to $\nabla^T_i$ and completes the proof.
\end{proof}

A similar construction was presented by Andrew and M. Weiss in \cite[Proposition~5.3]{ranicki1990assembly}.
In the simply-connected case, $\nabla_0$ agrees with their coaction of the Alexander--Whitney coalgebra of $X$ on $\assembly \cN$.

\subsection{Full embedding}\label{ss:full embedding}

We now prove the main result of this work, for which we are \textbf{not} assuming the simplicial complex $X$ to be simply-connected.

\begin{theorem*}
	The assembly functor from chain complex valued presheaves on $X$ to comodules over the symmetric coalgebra $\chains(X)$ is full and faithful.
\end{theorem*}

\begin{proof}
	\input{sec/proof}
\end{proof}