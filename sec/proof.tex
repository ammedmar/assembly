% !TeX root = ../thesis.tex

Consider two presheaves $\cN$ and $\cN'$ over $X$ and the function
\[
\Fun(X^\op, \Ch)(\cN, \cN') \to \coMod^{\Sym_2}_{\chains(X)}(\assembly \cN, \assembly \cN').
\]
induced by the assembly functor.
We will show this to be a bijection.

For a simplex $x$ in $X$ we write throughout this proof $x$ for both the basis element it represents in $\chains(X)$ and in $\chains(\bar x)$ which corresponds to the identity $(x \to x)$.

We start by showing that the chain map above is injective.
Consider a morphism of presheaves $F \colon \cN \to \cN'$ with $\assembly F = 0$.
For each simplex $x$ choose a basis $B_x$ of $\cN_x$ and notice that
\[
B = \set[\big]{[x \ot b] \mid x \in X, b \in B_x}
\]
is a basis for $\assembly \cN$.
By assumption we have $\assembly F [x \ot b] \defeq [x \ot F_x(b)] = 0$ for each $[x \ot b] \in B$, which implies $F_x(b) = 0$ and consequently $F = 0$.

Let us now move to surjectivity.
Consider a morphism of comodules $f \colon \assembly \cN \to \assembly \cN'$.
We will construct a morphism of presheaves $F \colon \cN \to \cN'$ such that $\assembly F = f$.
Consider $x \in X$, $c \in \cN_x$ and the class $[x \ot c] \in \assembly \cN$.
Its image under $f$ is of the form
\[
f \big( [x \ot c] \big) = \sum_{\lambda \in \Lambda} \, [x_\lambda \ot c_\lambda]
\]
where $x_\lambda \in X$ and $c_\lambda \in \cN'_{x_\lambda}$.
We will first show that for each $\lambda$ in the (finite) sum above the dimensions satisfy $\bars{x_\lambda} \leq \bars{x}$.
Let $i = \max \set[\big]{\bars{x_\lambda} : \lambda \in \Lambda}$ and $\Lambda_i = \set[\big]{\lambda \in \Lambda : \bars{x_\lambda} = i}$.
Notice that $\copr_i(x_{\lambda}) = x_{\lambda} \ot x_{\lambda}$ for $\lambda \in \Lambda_i$ and $\copr_i(x_{\lambda}) = 0$ for $\lambda \notin \Lambda_i$.
Assume $i > \bars{x}$ so that $\copr_i(x) = 0$.
%and considering $\nabla_i$.
%The comodule map property of $f$ implies, since , that
Therefore,
\begin{align*}
	0 =
	(\id \ot f) \circ \nabla_i [x \ot c] =
	\nabla_i \circ f \big( [x \ot c] \big) =
	\nabla_i \sum_{\lambda \in \Lambda} \, [x_\lambda \ot c_\lambda] =
	\sum_{\lambda \in \Lambda_i} \, x_\lambda \ot [x_\lambda \ot c_\lambda],
\end{align*}
which implies $[x_\lambda \ot c_\lambda] = 0$ and consequently $c_{\lambda} = 0$ for each $\lambda \in \Lambda_i$.

We will now show that $\Lambda$ has a single element $\lambda$ with $x_\lambda = x$.
Let $i = \bars{x}$, so
\begin{equation*} % \label{e:first in surjectivity}
	(\id \ot f) \circ \nabla_i \big( [x \ot c] \big) =
	x \ot f \big( [x \ot c] \big) =
	\sum_{\lambda \in \Lambda} \, x \ot [x_\lambda \ot c_\lambda]
\end{equation*}
and
\begin{equation*} % \label{e:second in surjectivity}
	\nabla_i \circ f \big( [x \ot c] \big) =
	\sum_{\lambda \in \Lambda_i} \, x_\lambda \ot [x_\lambda \ot c_\lambda].
\end{equation*}
Consequently
\[
\sum_{\lambda \in \Lambda} \, x \ot [x_\lambda \ot c_\lambda] =
\sum_{\lambda \in \Lambda_i} \, x_\lambda \ot [x_\lambda \ot c_\lambda],
\]
from which the claim follows.
%The comodule property of $f$ implies the elements in \cref{e:first in surjectivity,e:second in surjectivity} are equal, from which it follows that $\Lambda$ contains a single element $\lambda$ and $x_{\lambda} = x$.
Denoting $c_\lambda$ by $c'$ we have that $f \big( [x \ot c] \big) = [x \ot c']$, which we use to define $F_x(c) = c'$.

We will next verify that $F$ is a well defined morphism of presheaves.
That is to say, that for any morphism $x \to y$ and $c \in \cN_y$ we have
\[
\cN'_{x \to y} \circ F_y(c) = F_x \circ \cN_{x \to y}(c).
\]
It suffices to consider morphisms $\face_u x \to x$ where $\face_u x$ is obtained by removing the vertex of $x$ in position $u$.
Let $i = \bars{x}-1$ so that
\[
\copr_i(x) \ =
\sum_{u \text{ even}} \pm \face_u(x) \ot x \ +
\sum_{u \text{ odd}} \pm \, x \ot \face_u(x).
\]
Therefore, on one hand we have that $(\id \ot f) \circ \nabla_i [x \ot c]$ is equal to
\begin{align*}
%	&\sum_{u \text{ even}} \pm f [c \ot \face_u(x) \to x] \ot x \ +
%	\sum_{u \text{ odd}} \pm \, f [c \ot x] \ot \face_u(x) \\ =
%	&\sum_{u \text{ even}} \pm f [\cN_{\face_u(x) \to x}(c) \ot \face_u(x)] \ot x \ +
%	\sum_{u \text{ odd}} \pm \, f [c \ot x] \ot \face_u(x) \\ =
	&\sum_{u \text{ even}} \pm x \ot [\face_u(x) \ot \cN_{\face_u(x) \to x}(c)'] \ +
	\sum_{u \text{ odd}} \pm \, \face_u(x) \ot [x \ot c'],
\end{align*}
while on the other that $\nabla_i \circ f \big( [x \ot c] \big) = \nabla_i [x \ot c']$ is equal to
\begin{align*}
%	&\sum_{u \text{ even}} \pm [c' \ot \face_u(x) \to x] \ot x \ +
%	\sum_{u \text{ odd}} \pm \, [c' \ot x] \ot \face_u(x) \\
	&\sum_{u \text{ even}} \pm x \ot [\face_u(x) \ot \cN'_{\face_u(x) \to x}(c')] \ +
	\sum_{u \text{ odd}} \pm \, \face_u(x) \ot [x \ot c'].
\end{align*}
Putting these together it follows that
\[
	\sum_{u \text{ even}} \pm [\face_u(x) \ot \cN_{\face_u(x) \to x}(c)'] \ =
	\sum_{u \text{ even}} \pm [\face_u(x) \ot \cN'_{\face_u(x) \to x}(c')]
\]
and, consequently, that for $u$ even
\begin{align*}
	F_{\face_u(x)} \circ \cN_{\face_u(x) \to x}(c) &=
	\cN_{\face_u(x) \to x}(c)' \\ &=
	\cN'_{\face_u(x) \to x}(c') \\ &=
	\cN'_{\face_u(x) \to x} \circ F_{x}(c)
\end{align*}
as desired.
For $u$ odd we repeat the same argument using $\nabla_i^T$ instead of $\nabla_i$.
%\begin{equation*} % \label{e:first in surjectivity}
%	(f \ot \id) \circ \nabla_i \big( [c \ot x] \big) =
%	f \big( [c \ot x] \big) \ot x =
%	\sum_{\lambda \in \Lambda} \, [c_\lambda \ot x_\lambda] \ot x
%\end{equation*}
%and
%\begin{equation*} % \label{e:second in surjectivity}
%	\nabla_i \circ f \big( [c \ot x] \big) =
%	\sum_{\lambda \in \Lambda_i} \, [c_\lambda \ot x_\lambda] \ot x_\lambda.
%\end{equation*}
%Consequently
%\[
%\sum_{\lambda \in \Lambda} \, [c_\lambda \ot x_\lambda] \ot x =
%\sum_{\lambda \in \Lambda_i} \, [c_\lambda \ot x_\lambda] \ot x_\lambda,
%\]